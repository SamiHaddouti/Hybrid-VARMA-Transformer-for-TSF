Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='104_60', model='PatchTST', data='custom', root_path='./dataset/', data_path='national_illness_VARMA_Residuals.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=104, label_len=48, pred_len=60, fc_dropout=0.3, head_dropout=0.0, patch_len=24, stride=2, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=16, patience=100, learning_rate=0.0025, des='Exp', loss='mse', lradj='constant', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 104_60_PatchTST_custom_ftM_sl104_ll48_pl60_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 513
val 38
test 134
Epoch: 1 cost time: 1.4487361907958984
Epoch: 1, Steps: 32 | Train Loss: 1.0419693 Vali Loss: 0.4798639 Test Loss: 2.9627438
Validation loss decreased (inf --> 0.479864).  Saving model ...
Updating learning rate to 0.0025
Epoch: 2 cost time: 0.718095064163208
Epoch: 2, Steps: 32 | Train Loss: 0.8778419 Vali Loss: 0.4496641 Test Loss: 1.9599793
Validation loss decreased (0.479864 --> 0.449664).  Saving model ...
Updating learning rate to 0.0025
Epoch: 3 cost time: 0.729191780090332
Epoch: 3, Steps: 32 | Train Loss: 0.6318975 Vali Loss: 0.3685469 Test Loss: 2.1662855
Validation loss decreased (0.449664 --> 0.368547).  Saving model ...
Updating learning rate to 0.0025
Epoch: 4 cost time: 0.7436048984527588
Epoch: 4, Steps: 32 | Train Loss: 0.5344311 Vali Loss: 0.3422369 Test Loss: 2.0838115
Validation loss decreased (0.368547 --> 0.342237).  Saving model ...
Updating learning rate to 0.0025
Epoch: 5 cost time: 0.7510597705841064
Epoch: 5, Steps: 32 | Train Loss: 0.4870174 Vali Loss: 0.3329759 Test Loss: 2.0956686
Validation loss decreased (0.342237 --> 0.332976).  Saving model ...
Updating learning rate to 0.0025
Epoch: 6 cost time: 0.8091061115264893
Epoch: 6, Steps: 32 | Train Loss: 0.4605525 Vali Loss: 0.3831941 Test Loss: 1.7060251
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 7 cost time: 0.7496130466461182
Epoch: 7, Steps: 32 | Train Loss: 0.4383139 Vali Loss: 0.3576447 Test Loss: 1.7179188
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 8 cost time: 0.7087142467498779
Epoch: 8, Steps: 32 | Train Loss: 0.4146702 Vali Loss: 0.3655372 Test Loss: 1.8210201
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 9 cost time: 0.7175045013427734
Epoch: 9, Steps: 32 | Train Loss: 0.3763139 Vali Loss: 0.3197088 Test Loss: 1.6411417
Validation loss decreased (0.332976 --> 0.319709).  Saving model ...
Updating learning rate to 0.0025
Epoch: 10 cost time: 0.7281439304351807
Epoch: 10, Steps: 32 | Train Loss: 0.3546685 Vali Loss: 0.3008625 Test Loss: 1.8468645
Validation loss decreased (0.319709 --> 0.300862).  Saving model ...
Updating learning rate to 0.0025
Epoch: 11 cost time: 0.7251458168029785
Epoch: 11, Steps: 32 | Train Loss: 0.3340842 Vali Loss: 0.2883740 Test Loss: 1.5061816
Validation loss decreased (0.300862 --> 0.288374).  Saving model ...
Updating learning rate to 0.0025
Epoch: 12 cost time: 0.7180459499359131
Epoch: 12, Steps: 32 | Train Loss: 0.3186027 Vali Loss: 0.2954671 Test Loss: 1.4580835
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 13 cost time: 0.7702844142913818
Epoch: 13, Steps: 32 | Train Loss: 0.3150933 Vali Loss: 0.2983302 Test Loss: 1.6472280
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 14 cost time: 0.819979190826416
Epoch: 14, Steps: 32 | Train Loss: 0.2957573 Vali Loss: 0.3244533 Test Loss: 1.5748279
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 15 cost time: 0.755894660949707
Epoch: 15, Steps: 32 | Train Loss: 0.2905196 Vali Loss: 0.3246067 Test Loss: 1.5538074
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 16 cost time: 0.720146656036377
Epoch: 16, Steps: 32 | Train Loss: 0.2874036 Vali Loss: 0.2886956 Test Loss: 1.5024590
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.0025
Epoch: 17 cost time: 0.7158851623535156
Epoch: 17, Steps: 32 | Train Loss: 0.2824846 Vali Loss: 0.2809538 Test Loss: 1.4953682
Validation loss decreased (0.288374 --> 0.280954).  Saving model ...
Updating learning rate to 0.0025
Epoch: 18 cost time: 0.7291195392608643
Epoch: 18, Steps: 32 | Train Loss: 0.2698191 Vali Loss: 0.3270235 Test Loss: 1.5354843
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 19 cost time: 0.7160720825195312
Epoch: 19, Steps: 32 | Train Loss: 0.2647055 Vali Loss: 0.2950882 Test Loss: 1.4490411
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 20 cost time: 0.728492021560669
Epoch: 20, Steps: 32 | Train Loss: 0.2629814 Vali Loss: 0.3563312 Test Loss: 1.4060427
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 21 cost time: 0.7259676456451416
Epoch: 21, Steps: 32 | Train Loss: 0.2526717 Vali Loss: 0.2892758 Test Loss: 1.4830375
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 22 cost time: 0.809152364730835
Epoch: 22, Steps: 32 | Train Loss: 0.2526160 Vali Loss: 0.3445862 Test Loss: 1.5118468
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.0025
Epoch: 23 cost time: 0.7368462085723877
Epoch: 23, Steps: 32 | Train Loss: 0.2518202 Vali Loss: 0.3927612 Test Loss: 1.5372950
EarlyStopping counter: 6 out of 100
Updating learning rate to 0.0025
Epoch: 24 cost time: 0.7149491310119629
Epoch: 24, Steps: 32 | Train Loss: 0.2527376 Vali Loss: 0.3011692 Test Loss: 1.4010090
EarlyStopping counter: 7 out of 100
Updating learning rate to 0.0025
Epoch: 25 cost time: 0.7028994560241699
Epoch: 25, Steps: 32 | Train Loss: 0.2452954 Vali Loss: 0.3315320 Test Loss: 1.3872733
EarlyStopping counter: 8 out of 100
Updating learning rate to 0.0025
Epoch: 26 cost time: 0.7081711292266846
Epoch: 26, Steps: 32 | Train Loss: 0.2348491 Vali Loss: 0.3304083 Test Loss: 1.4204018
EarlyStopping counter: 9 out of 100
Updating learning rate to 0.0025
Epoch: 27 cost time: 0.7312235832214355
Epoch: 27, Steps: 32 | Train Loss: 0.2353883 Vali Loss: 0.3002293 Test Loss: 1.4481555
EarlyStopping counter: 10 out of 100
Updating learning rate to 0.0025
Epoch: 28 cost time: 0.7216169834136963
Epoch: 28, Steps: 32 | Train Loss: 0.2300931 Vali Loss: 0.3438899 Test Loss: 1.3333983
EarlyStopping counter: 11 out of 100
Updating learning rate to 0.0025
Epoch: 29 cost time: 0.7135233879089355
Epoch: 29, Steps: 32 | Train Loss: 0.2352764 Vali Loss: 0.3617035 Test Loss: 1.5281727
EarlyStopping counter: 12 out of 100
Updating learning rate to 0.0025
Epoch: 30 cost time: 0.8029541969299316
Epoch: 30, Steps: 32 | Train Loss: 0.2382473 Vali Loss: 0.3759829 Test Loss: 1.3078946
EarlyStopping counter: 13 out of 100
Updating learning rate to 0.0025
Epoch: 31 cost time: 0.7145390510559082
Epoch: 31, Steps: 32 | Train Loss: 0.2248017 Vali Loss: 0.3179339 Test Loss: 1.3775320
EarlyStopping counter: 14 out of 100
Updating learning rate to 0.0025
Epoch: 32 cost time: 0.7376625537872314
Epoch: 32, Steps: 32 | Train Loss: 0.2173613 Vali Loss: 0.3154147 Test Loss: 1.3831853
EarlyStopping counter: 15 out of 100
Updating learning rate to 0.0025
Epoch: 33 cost time: 0.7756164073944092
Epoch: 33, Steps: 32 | Train Loss: 0.2206660 Vali Loss: 0.3326988 Test Loss: 1.5761664
EarlyStopping counter: 16 out of 100
Updating learning rate to 0.0025
Epoch: 34 cost time: 0.7108969688415527
Epoch: 34, Steps: 32 | Train Loss: 0.2263409 Vali Loss: 0.3681647 Test Loss: 1.2314670
EarlyStopping counter: 17 out of 100
Updating learning rate to 0.0025
Epoch: 35 cost time: 0.7216320037841797
Epoch: 35, Steps: 32 | Train Loss: 0.2157698 Vali Loss: 0.2900435 Test Loss: 1.4981323
EarlyStopping counter: 18 out of 100
Updating learning rate to 0.0025
Epoch: 36 cost time: 0.7318179607391357
Epoch: 36, Steps: 32 | Train Loss: 0.2154853 Vali Loss: 0.3896618 Test Loss: 1.2594279
EarlyStopping counter: 19 out of 100
Updating learning rate to 0.0025
Epoch: 37 cost time: 0.7467837333679199
Epoch: 37, Steps: 32 | Train Loss: 0.2074305 Vali Loss: 0.2964137 Test Loss: 1.3342414
EarlyStopping counter: 20 out of 100
Updating learning rate to 0.0025
Epoch: 38 cost time: 0.8274846076965332
Epoch: 38, Steps: 32 | Train Loss: 0.2101223 Vali Loss: 0.3355256 Test Loss: 1.2915105
EarlyStopping counter: 21 out of 100
Updating learning rate to 0.0025
Epoch: 39 cost time: 0.7329339981079102
Epoch: 39, Steps: 32 | Train Loss: 0.2044055 Vali Loss: 0.3570638 Test Loss: 1.3248681
EarlyStopping counter: 22 out of 100
Updating learning rate to 0.0025
Epoch: 40 cost time: 0.7082364559173584
Epoch: 40, Steps: 32 | Train Loss: 0.1979391 Vali Loss: 0.2965796 Test Loss: 1.5017583
EarlyStopping counter: 23 out of 100
Updating learning rate to 0.0025
Epoch: 41 cost time: 0.7147986888885498
Epoch: 41, Steps: 32 | Train Loss: 0.2020615 Vali Loss: 0.2943475 Test Loss: 1.2995620
EarlyStopping counter: 24 out of 100
Updating learning rate to 0.0025
Epoch: 42 cost time: 0.7799618244171143
Epoch: 42, Steps: 32 | Train Loss: 0.1950882 Vali Loss: 0.2891538 Test Loss: 1.3350679
EarlyStopping counter: 25 out of 100
Updating learning rate to 0.0025
Epoch: 43 cost time: 0.7520372867584229
Epoch: 43, Steps: 32 | Train Loss: 0.2028575 Vali Loss: 0.2902295 Test Loss: 1.3842807
EarlyStopping counter: 26 out of 100
Updating learning rate to 0.0025
Epoch: 44 cost time: 0.7277679443359375
Epoch: 44, Steps: 32 | Train Loss: 0.1921436 Vali Loss: 0.3061231 Test Loss: 1.3204069
EarlyStopping counter: 27 out of 100
Updating learning rate to 0.0025
Epoch: 45 cost time: 0.7479429244995117
Epoch: 45, Steps: 32 | Train Loss: 0.1900596 Vali Loss: 0.3470555 Test Loss: 1.3059014
EarlyStopping counter: 28 out of 100
Updating learning rate to 0.0025
Epoch: 46 cost time: 0.8363499641418457
Epoch: 46, Steps: 32 | Train Loss: 0.1885365 Vali Loss: 0.3191428 Test Loss: 1.3092928
EarlyStopping counter: 29 out of 100
Updating learning rate to 0.0025
Epoch: 47 cost time: 0.7328486442565918
Epoch: 47, Steps: 32 | Train Loss: 0.1915057 Vali Loss: 0.2887162 Test Loss: 1.3419309
EarlyStopping counter: 30 out of 100
Updating learning rate to 0.0025
Epoch: 48 cost time: 0.721311092376709
Epoch: 48, Steps: 32 | Train Loss: 0.1872847 Vali Loss: 0.3146636 Test Loss: 1.3218124
EarlyStopping counter: 31 out of 100
Updating learning rate to 0.0025
Epoch: 49 cost time: 0.7311828136444092
Epoch: 49, Steps: 32 | Train Loss: 0.1891863 Vali Loss: 0.2831045 Test Loss: 1.3896863
EarlyStopping counter: 32 out of 100
Updating learning rate to 0.0025
Epoch: 50 cost time: 0.7293086051940918
Epoch: 50, Steps: 32 | Train Loss: 0.1909571 Vali Loss: 0.2799111 Test Loss: 1.4516294
Validation loss decreased (0.280954 --> 0.279911).  Saving model ...
Updating learning rate to 0.0025
Epoch: 51 cost time: 0.7275230884552002
Epoch: 51, Steps: 32 | Train Loss: 0.1861914 Vali Loss: 0.3281732 Test Loss: 1.3210514
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 52 cost time: 0.7234938144683838
Epoch: 52, Steps: 32 | Train Loss: 0.1840762 Vali Loss: 0.2615847 Test Loss: 1.5363444
Validation loss decreased (0.279911 --> 0.261585).  Saving model ...
Updating learning rate to 0.0025
Epoch: 53 cost time: 0.8394820690155029
Epoch: 53, Steps: 32 | Train Loss: 0.1822314 Vali Loss: 0.2807029 Test Loss: 1.3203146
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 54 cost time: 0.8026134967803955
Epoch: 54, Steps: 32 | Train Loss: 0.1819945 Vali Loss: 0.2943441 Test Loss: 1.3085222
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 55 cost time: 0.7243614196777344
Epoch: 55, Steps: 32 | Train Loss: 0.1865428 Vali Loss: 0.2788773 Test Loss: 1.2723718
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 56 cost time: 0.7309861183166504
Epoch: 56, Steps: 32 | Train Loss: 0.1929280 Vali Loss: 0.2755360 Test Loss: 1.4628948
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 57 cost time: 0.702972412109375
Epoch: 57, Steps: 32 | Train Loss: 0.1830593 Vali Loss: 0.2733589 Test Loss: 1.3183140
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.0025
Epoch: 58 cost time: 0.7169268131256104
Epoch: 58, Steps: 32 | Train Loss: 0.1778098 Vali Loss: 0.2563028 Test Loss: 1.3691692
Validation loss decreased (0.261585 --> 0.256303).  Saving model ...
Updating learning rate to 0.0025
Epoch: 59 cost time: 0.7138185501098633
Epoch: 59, Steps: 32 | Train Loss: 0.1698248 Vali Loss: 0.2909399 Test Loss: 1.3899887
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 60 cost time: 0.715050220489502
Epoch: 60, Steps: 32 | Train Loss: 0.1710479 Vali Loss: 0.2853990 Test Loss: 1.3080652
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 61 cost time: 0.821904182434082
Epoch: 61, Steps: 32 | Train Loss: 0.1709884 Vali Loss: 0.3135717 Test Loss: 1.2779620
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 62 cost time: 0.7250933647155762
Epoch: 62, Steps: 32 | Train Loss: 0.1733126 Vali Loss: 0.2746257 Test Loss: 1.3576388
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 63 cost time: 0.7529952526092529
Epoch: 63, Steps: 32 | Train Loss: 0.1724669 Vali Loss: 0.3057585 Test Loss: 1.4282672
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.0025
Epoch: 64 cost time: 0.7232885360717773
Epoch: 64, Steps: 32 | Train Loss: 0.1674144 Vali Loss: 0.2865124 Test Loss: 1.4256971
EarlyStopping counter: 6 out of 100
Updating learning rate to 0.0025
Epoch: 65 cost time: 0.7440323829650879
Epoch: 65, Steps: 32 | Train Loss: 0.1724638 Vali Loss: 0.3072304 Test Loss: 1.3371075
EarlyStopping counter: 7 out of 100
Updating learning rate to 0.0025
Epoch: 66 cost time: 0.7278447151184082
Epoch: 66, Steps: 32 | Train Loss: 0.1693830 Vali Loss: 0.2627805 Test Loss: 1.3979720
EarlyStopping counter: 8 out of 100
Updating learning rate to 0.0025
Epoch: 67 cost time: 0.7099647521972656
Epoch: 67, Steps: 32 | Train Loss: 0.1747963 Vali Loss: 0.3406712 Test Loss: 1.2417638
EarlyStopping counter: 9 out of 100
Updating learning rate to 0.0025
Epoch: 68 cost time: 0.7192273139953613
Epoch: 68, Steps: 32 | Train Loss: 0.1719402 Vali Loss: 0.2627219 Test Loss: 1.4187534
EarlyStopping counter: 10 out of 100
Updating learning rate to 0.0025
Epoch: 69 cost time: 0.817662239074707
Epoch: 69, Steps: 32 | Train Loss: 0.1704157 Vali Loss: 0.2987571 Test Loss: 1.3004146
EarlyStopping counter: 11 out of 100
Updating learning rate to 0.0025
Epoch: 70 cost time: 0.7486531734466553
Epoch: 70, Steps: 32 | Train Loss: 0.1684985 Vali Loss: 0.2604277 Test Loss: 1.4549417
EarlyStopping counter: 12 out of 100
Updating learning rate to 0.0025
Epoch: 71 cost time: 0.7224061489105225
Epoch: 71, Steps: 32 | Train Loss: 0.1653493 Vali Loss: 0.3062678 Test Loss: 1.2989283
EarlyStopping counter: 13 out of 100
Updating learning rate to 0.0025
Epoch: 72 cost time: 0.7287921905517578
Epoch: 72, Steps: 32 | Train Loss: 0.1661312 Vali Loss: 0.2755935 Test Loss: 1.3252939
EarlyStopping counter: 14 out of 100
Updating learning rate to 0.0025
Epoch: 73 cost time: 0.7237124443054199
Epoch: 73, Steps: 32 | Train Loss: 0.1640384 Vali Loss: 0.3240783 Test Loss: 1.2586601
EarlyStopping counter: 15 out of 100
Updating learning rate to 0.0025
Epoch: 74 cost time: 0.7286233901977539
Epoch: 74, Steps: 32 | Train Loss: 0.1674114 Vali Loss: 0.2702493 Test Loss: 1.4804504
EarlyStopping counter: 16 out of 100
Updating learning rate to 0.0025
Epoch: 75 cost time: 0.7331640720367432
Epoch: 75, Steps: 32 | Train Loss: 0.1607906 Vali Loss: 0.2625068 Test Loss: 1.3951389
EarlyStopping counter: 17 out of 100
Updating learning rate to 0.0025
Epoch: 76 cost time: 0.7249417304992676
Epoch: 76, Steps: 32 | Train Loss: 0.1616817 Vali Loss: 0.2763567 Test Loss: 1.4071726
EarlyStopping counter: 18 out of 100
Updating learning rate to 0.0025
Epoch: 77 cost time: 0.8285894393920898
Epoch: 77, Steps: 32 | Train Loss: 0.1623777 Vali Loss: 0.3377852 Test Loss: 1.2929817
EarlyStopping counter: 19 out of 100
Updating learning rate to 0.0025
Epoch: 78 cost time: 0.7293288707733154
Epoch: 78, Steps: 32 | Train Loss: 0.1664385 Vali Loss: 0.2780465 Test Loss: 1.4068326
EarlyStopping counter: 20 out of 100
Updating learning rate to 0.0025
Epoch: 79 cost time: 0.714993953704834
Epoch: 79, Steps: 32 | Train Loss: 0.1657015 Vali Loss: 0.2734845 Test Loss: 1.4865338
EarlyStopping counter: 21 out of 100
Updating learning rate to 0.0025
Epoch: 80 cost time: 0.7220447063446045
Epoch: 80, Steps: 32 | Train Loss: 0.1648192 Vali Loss: 0.2926981 Test Loss: 1.3160882
EarlyStopping counter: 22 out of 100
Updating learning rate to 0.0025
Epoch: 81 cost time: 0.7375504970550537
Epoch: 81, Steps: 32 | Train Loss: 0.1638257 Vali Loss: 0.2694803 Test Loss: 1.3170750
EarlyStopping counter: 23 out of 100
Updating learning rate to 0.0025
Epoch: 82 cost time: 0.7102885246276855
Epoch: 82, Steps: 32 | Train Loss: 0.1614935 Vali Loss: 0.2952460 Test Loss: 1.3124697
EarlyStopping counter: 24 out of 100
Updating learning rate to 0.0025
Epoch: 83 cost time: 0.7302038669586182
Epoch: 83, Steps: 32 | Train Loss: 0.1566369 Vali Loss: 0.2636364 Test Loss: 1.4271512
EarlyStopping counter: 25 out of 100
Updating learning rate to 0.0025
Epoch: 84 cost time: 0.7699856758117676
Epoch: 84, Steps: 32 | Train Loss: 0.1589354 Vali Loss: 0.2628574 Test Loss: 1.2838314
EarlyStopping counter: 26 out of 100
Updating learning rate to 0.0025
Epoch: 85 cost time: 0.8142940998077393
Epoch: 85, Steps: 32 | Train Loss: 0.1606615 Vali Loss: 0.2692524 Test Loss: 1.4556532
EarlyStopping counter: 27 out of 100
Updating learning rate to 0.0025
Epoch: 86 cost time: 0.7316312789916992
Epoch: 86, Steps: 32 | Train Loss: 0.1567063 Vali Loss: 0.2843153 Test Loss: 1.3384315
EarlyStopping counter: 28 out of 100
Updating learning rate to 0.0025
Epoch: 87 cost time: 0.7268831729888916
Epoch: 87, Steps: 32 | Train Loss: 0.1564503 Vali Loss: 0.2633895 Test Loss: 1.3945906
EarlyStopping counter: 29 out of 100
Updating learning rate to 0.0025
Epoch: 88 cost time: 0.721790075302124
Epoch: 88, Steps: 32 | Train Loss: 0.1618518 Vali Loss: 0.2747027 Test Loss: 1.5813743
EarlyStopping counter: 30 out of 100
Updating learning rate to 0.0025
Epoch: 89 cost time: 0.7557644844055176
Epoch: 89, Steps: 32 | Train Loss: 0.1736534 Vali Loss: 0.2996972 Test Loss: 1.3082581
EarlyStopping counter: 31 out of 100
Updating learning rate to 0.0025
Epoch: 90 cost time: 0.7419130802154541
Epoch: 90, Steps: 32 | Train Loss: 0.1595659 Vali Loss: 0.3030980 Test Loss: 1.4367105
EarlyStopping counter: 32 out of 100
Updating learning rate to 0.0025
Epoch: 91 cost time: 0.7169697284698486
Epoch: 91, Steps: 32 | Train Loss: 0.1562945 Vali Loss: 0.2520481 Test Loss: 1.4138565
Validation loss decreased (0.256303 --> 0.252048).  Saving model ...
Updating learning rate to 0.0025
Epoch: 92 cost time: 0.8134627342224121
Epoch: 92, Steps: 32 | Train Loss: 0.1591522 Vali Loss: 0.2648367 Test Loss: 1.4049598
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0025
Epoch: 93 cost time: 0.7288591861724854
Epoch: 93, Steps: 32 | Train Loss: 0.1562851 Vali Loss: 0.2859090 Test Loss: 1.4169868
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0025
Epoch: 94 cost time: 0.7200734615325928
Epoch: 94, Steps: 32 | Train Loss: 0.1538828 Vali Loss: 0.2821286 Test Loss: 1.2725390
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0025
Epoch: 95 cost time: 0.711014986038208
Epoch: 95, Steps: 32 | Train Loss: 0.1595062 Vali Loss: 0.2737340 Test Loss: 1.3010826
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0025
Epoch: 96 cost time: 0.7369349002838135
Epoch: 96, Steps: 32 | Train Loss: 0.1538878 Vali Loss: 0.2701707 Test Loss: 1.4611142
EarlyStopping counter: 5 out of 100
Updating learning rate to 0.0025
Epoch: 97 cost time: 0.7536077499389648
Epoch: 97, Steps: 32 | Train Loss: 0.1565326 Vali Loss: 0.2560050 Test Loss: 1.4456545
EarlyStopping counter: 6 out of 100
Updating learning rate to 0.0025
Epoch: 98 cost time: 0.7218003273010254
Epoch: 98, Steps: 32 | Train Loss: 0.1534106 Vali Loss: 0.2598728 Test Loss: 1.3815932
EarlyStopping counter: 7 out of 100
Updating learning rate to 0.0025
Epoch: 99 cost time: 0.7390663623809814
Epoch: 99, Steps: 32 | Train Loss: 0.1549352 Vali Loss: 0.2722699 Test Loss: 1.3790892
EarlyStopping counter: 8 out of 100
Updating learning rate to 0.0025
Epoch: 100 cost time: 0.869753360748291
Epoch: 100, Steps: 32 | Train Loss: 0.1564191 Vali Loss: 0.2737705 Test Loss: 1.4278623
EarlyStopping counter: 9 out of 100
Updating learning rate to 0.0025
>>>>>>>testing : 104_60_PatchTST_custom_ftM_sl104_ll48_pl60_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 134
mse:1.4138563871383667, mae:0.7797119617462158, rse:0.5676940083503723
