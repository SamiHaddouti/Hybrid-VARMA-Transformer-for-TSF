Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='336_720', model='PatchTST', data='custom', root_path='./dataset/', data_path='exchange_rate_VARMA_All_Residuals.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.2, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4256
val 41
test 798
	iters: 100, epoch: 1 | loss: 1.0776329
	speed: 0.0643s/iter; left time: 849.0732s
Epoch: 1 cost time: 8.277930498123169
Epoch: 1, Steps: 133 | Train Loss: 1.1092535 Vali Loss: 1.4235895 Test Loss: 8.7983580
Validation loss decreased (inf --> 1.423589).  Saving model ...
Updating learning rate to 4.591403317489266e-06
	iters: 100, epoch: 2 | loss: 1.1392733
	speed: 0.0919s/iter; left time: 1200.5138s
Epoch: 2 cost time: 7.584355354309082
Epoch: 2, Steps: 133 | Train Loss: 1.0244356 Vali Loss: 1.4829651 Test Loss: 8.7279930
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.351040024792963e-06
	iters: 100, epoch: 3 | loss: 1.0570424
	speed: 0.0930s/iter; left time: 1202.6184s
Epoch: 3 cost time: 7.736527681350708
Epoch: 3, Steps: 133 | Train Loss: 0.9692528 Vali Loss: 1.5353527 Test Loss: 8.6798010
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.235549497482972e-06
	iters: 100, epoch: 4 | loss: 0.9055904
	speed: 0.0920s/iter; left time: 1177.5808s
Epoch: 4 cost time: 7.655838489532471
Epoch: 4, Steps: 133 | Train Loss: 0.9217643 Vali Loss: 1.5444939 Test Loss: 8.6432600
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3173852215914392e-05
	iters: 100, epoch: 5 | loss: 0.8891248
	speed: 0.0906s/iter; left time: 1147.4089s
Epoch: 5 cost time: 7.59961462020874
Epoch: 5, Steps: 133 | Train Loss: 0.8980456 Vali Loss: 1.5705547 Test Loss: 8.6193762
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.806890129288065e-05
	iters: 100, epoch: 6 | loss: 0.7836266
	speed: 0.0916s/iter; left time: 1148.2903s
Epoch: 6 cost time: 7.550799369812012
Epoch: 6, Steps: 133 | Train Loss: 0.8893441 Vali Loss: 1.5491434 Test Loss: 8.6205826
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.3800073884073822e-05
	iters: 100, epoch: 7 | loss: 0.9333114
	speed: 0.0904s/iter; left time: 1121.5701s
Epoch: 7 cost time: 7.5692009925842285
Epoch: 7, Steps: 133 | Train Loss: 0.8838638 Vali Loss: 1.5126127 Test Loss: 8.6139250
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.022614355267992e-05
	iters: 100, epoch: 8 | loss: 0.8904471
	speed: 0.0913s/iter; left time: 1120.0439s
Epoch: 8 cost time: 7.583022356033325
Epoch: 8, Steps: 133 | Train Loss: 0.8805523 Vali Loss: 1.4417803 Test Loss: 8.6137581
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.718876034368101e-05
	iters: 100, epoch: 9 | loss: 0.8285519
	speed: 0.0908s/iter; left time: 1102.0027s
Epoch: 9 cost time: 7.6233251094818115
Epoch: 9, Steps: 133 | Train Loss: 0.8768024 Vali Loss: 1.4833496 Test Loss: 8.6070871
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.451635281255191e-05
	iters: 100, epoch: 10 | loss: 0.8127515
	speed: 0.0922s/iter; left time: 1107.3689s
Epoch: 10 cost time: 7.602614879608154
Epoch: 10, Steps: 133 | Train Loss: 0.8738882 Vali Loss: 1.4095622 Test Loss: 8.6081305
Validation loss decreased (1.423589 --> 1.409562).  Saving model ...
Updating learning rate to 5.2028355855321824e-05
	iters: 100, epoch: 11 | loss: 0.9070760
	speed: 0.0922s/iter; left time: 1094.6096s
Epoch: 11 cost time: 7.700055360794067
Epoch: 11, Steps: 133 | Train Loss: 0.8709380 Vali Loss: 1.3897669 Test Loss: 8.6236916
Validation loss decreased (1.409562 --> 1.389767).  Saving model ...
Updating learning rate to 5.953966015863723e-05
	iters: 100, epoch: 12 | loss: 0.8866932
	speed: 0.0914s/iter; left time: 1072.3099s
Epoch: 12 cost time: 7.611822605133057
Epoch: 12, Steps: 133 | Train Loss: 0.8651679 Vali Loss: 1.3880194 Test Loss: 8.6148453
Validation loss decreased (1.389767 --> 1.388019).  Saving model ...
Updating learning rate to 6.6865173627346e-05
	iters: 100, epoch: 13 | loss: 0.8016706
	speed: 0.0910s/iter; left time: 1055.8694s
Epoch: 13 cost time: 7.60112738609314
Epoch: 13, Steps: 133 | Train Loss: 0.8572559 Vali Loss: 1.2848638 Test Loss: 8.6298771
Validation loss decreased (1.388019 --> 1.284864).  Saving model ...
Updating learning rate to 7.38243823877937e-05
	iters: 100, epoch: 14 | loss: 0.9189334
	speed: 0.0924s/iter; left time: 1059.7503s
Epoch: 14 cost time: 7.584161996841431
Epoch: 14, Steps: 133 | Train Loss: 0.8455778 Vali Loss: 1.3952801 Test Loss: 8.6069460
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.024579897547907e-05
	iters: 100, epoch: 15 | loss: 0.9649485
	speed: 0.0908s/iter; left time: 1029.6501s
Epoch: 15 cost time: 7.624757528305054
Epoch: 15, Steps: 133 | Train Loss: 0.8307828 Vali Loss: 1.3598893 Test Loss: 8.6005936
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.597118809569642e-05
	iters: 100, epoch: 16 | loss: 0.7725105
	speed: 0.0910s/iter; left time: 1019.7873s
Epoch: 16 cost time: 7.571915149688721
Epoch: 16, Steps: 133 | Train Loss: 0.8150909 Vali Loss: 1.4018353 Test Loss: 8.6770859
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.085946582679517e-05
	iters: 100, epoch: 17 | loss: 0.9278207
	speed: 0.0904s/iter; left time: 1001.0766s
Epoch: 17 cost time: 7.598722219467163
Epoch: 17, Steps: 133 | Train Loss: 0.8089199 Vali Loss: 1.4108691 Test Loss: 8.6736526
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.479017618265112e-05
	iters: 100, epoch: 18 | loss: 0.7683291
	speed: 0.0922s/iter; left time: 1008.9008s
Epoch: 18 cost time: 7.600449085235596
Epoch: 18, Steps: 133 | Train Loss: 0.7916569 Vali Loss: 1.4975336 Test Loss: 8.6804800
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.766645936557502e-05
	iters: 100, epoch: 19 | loss: 0.7293957
	speed: 0.0912s/iter; left time: 985.4359s
Epoch: 19 cost time: 7.630265474319458
Epoch: 19, Steps: 133 | Train Loss: 0.7796705 Vali Loss: 1.4164722 Test Loss: 8.6972504
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.941743856654937e-05
	iters: 100, epoch: 20 | loss: 0.6901886
	speed: 0.0908s/iter; left time: 968.6948s
Epoch: 20 cost time: 7.5976784229278564
Epoch: 20, Steps: 133 | Train Loss: 0.7686995 Vali Loss: 1.4335936 Test Loss: 8.6957397
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.999999782051063e-05
	iters: 100, epoch: 21 | loss: 0.6411304
	speed: 0.0908s/iter; left time: 957.1561s
Epoch: 21 cost time: 7.647983074188232
Epoch: 21, Steps: 133 | Train Loss: 0.7596864 Vali Loss: 1.4189085 Test Loss: 8.6943731
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.996087019324302e-05
	iters: 100, epoch: 22 | loss: 0.7107462
	speed: 0.0920s/iter; left time: 957.2665s
Epoch: 22 cost time: 7.6116111278533936
Epoch: 22, Steps: 133 | Train Loss: 0.7473290 Vali Loss: 1.4512506 Test Loss: 8.6871786
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.984470683375906e-05
	iters: 100, epoch: 23 | loss: 0.7135192
	speed: 0.0916s/iter; left time: 941.5208s
Epoch: 23 cost time: 7.659819841384888
Epoch: 23, Steps: 133 | Train Loss: 0.7372391 Vali Loss: 1.5476898 Test Loss: 8.7004843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798
mse:8.629874229431152, mae:1.14560067653656, rse:0.9352931380271912
