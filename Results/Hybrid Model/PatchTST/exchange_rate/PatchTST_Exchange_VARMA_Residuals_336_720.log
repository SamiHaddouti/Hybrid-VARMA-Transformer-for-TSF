Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='336_720', model='PatchTST', data='custom', root_path='./dataset/', data_path='exchange_rate_VARMA_Residuals.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.2, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4256
val 41
test 798
	iters: 100, epoch: 1 | loss: 0.9362186
	speed: 0.0514s/iter; left time: 678.0208s
Epoch: 1 cost time: 6.578272342681885
Epoch: 1, Steps: 133 | Train Loss: 1.0424983 Vali Loss: 1.3392330 Test Loss: 10.4922781
Validation loss decreased (inf --> 1.339233).  Saving model ...
Updating learning rate to 4.591403317489266e-06
	iters: 100, epoch: 2 | loss: 1.0536482
	speed: 0.0728s/iter; left time: 951.8930s
Epoch: 2 cost time: 5.888939380645752
Epoch: 2, Steps: 133 | Train Loss: 0.9477532 Vali Loss: 1.4538182 Test Loss: 10.4316187
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.351040024792963e-06
	iters: 100, epoch: 3 | loss: 1.0087686
	speed: 0.0732s/iter; left time: 946.2863s
Epoch: 3 cost time: 5.936648607254028
Epoch: 3, Steps: 133 | Train Loss: 0.9052192 Vali Loss: 1.5468591 Test Loss: 10.3988581
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.235549497482972e-06
	iters: 100, epoch: 4 | loss: 0.8474551
	speed: 0.0727s/iter; left time: 931.2112s
Epoch: 4 cost time: 6.005574941635132
Epoch: 4, Steps: 133 | Train Loss: 0.8748067 Vali Loss: 1.5603373 Test Loss: 10.3756008
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3173852215914392e-05
	iters: 100, epoch: 5 | loss: 0.8264851
	speed: 0.0737s/iter; left time: 933.2678s
Epoch: 5 cost time: 5.971203088760376
Epoch: 5, Steps: 133 | Train Loss: 0.8579406 Vali Loss: 1.5927674 Test Loss: 10.3518238
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.806890129288065e-05
	iters: 100, epoch: 6 | loss: 0.7910186
	speed: 0.0717s/iter; left time: 898.8286s
Epoch: 6 cost time: 5.920246601104736
Epoch: 6, Steps: 133 | Train Loss: 0.8496386 Vali Loss: 1.5304821 Test Loss: 10.3621836
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.3800073884073822e-05
	iters: 100, epoch: 7 | loss: 0.9060889
	speed: 0.0733s/iter; left time: 909.3416s
Epoch: 7 cost time: 5.8989646434783936
Epoch: 7, Steps: 133 | Train Loss: 0.8450514 Vali Loss: 1.4602003 Test Loss: 10.3562660
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.022614355267992e-05
	iters: 100, epoch: 8 | loss: 0.7987446
	speed: 0.0717s/iter; left time: 879.1681s
Epoch: 8 cost time: 5.867591142654419
Epoch: 8, Steps: 133 | Train Loss: 0.8419856 Vali Loss: 1.3737885 Test Loss: 10.3494139
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.718876034368101e-05
	iters: 100, epoch: 9 | loss: 0.7582264
	speed: 0.0723s/iter; left time: 877.2557s
Epoch: 9 cost time: 5.905130863189697
Epoch: 9, Steps: 133 | Train Loss: 0.8378325 Vali Loss: 1.4416920 Test Loss: 10.3424273
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.451635281255191e-05
	iters: 100, epoch: 10 | loss: 0.8164874
	speed: 0.0715s/iter; left time: 858.8502s
Epoch: 10 cost time: 5.874260663986206
Epoch: 10, Steps: 133 | Train Loss: 0.8362211 Vali Loss: 1.3528016 Test Loss: 10.3535738
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.2028355855321824e-05
	iters: 100, epoch: 11 | loss: 0.9121311
	speed: 0.0718s/iter; left time: 852.0000s
Epoch: 11 cost time: 5.890507698059082
Epoch: 11, Steps: 133 | Train Loss: 0.8341352 Vali Loss: 1.3942767 Test Loss: 10.3635721
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798
mse:10.492280006408691, mae:1.2960610389709473, rse:0.9344929456710815
