Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='336_336', model='PatchTST', data='custom', root_path='./dataset/', data_path='exchange_rate.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.2, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_custom_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4640
val 425
test 1182
	iters: 100, epoch: 1 | loss: 0.5280054
	speed: 0.0452s/iter; left time: 651.3251s
Epoch: 1 cost time: 6.158749580383301
Epoch: 1, Steps: 145 | Train Loss: 0.5912381 Vali Loss: 0.5121716 Test Loss: 0.4001318
Validation loss decreased (inf --> 0.512172).  Saving model ...
Updating learning rate to 4.5913665813514395e-06
	iters: 100, epoch: 2 | loss: 0.4783984
	speed: 0.0686s/iter; left time: 978.1155s
Epoch: 2 cost time: 5.443396091461182
Epoch: 2, Steps: 145 | Train Loss: 0.5074883 Vali Loss: 0.4580988 Test Loss: 0.3596929
Validation loss decreased (0.512172 --> 0.458099).  Saving model ...
Updating learning rate to 6.350894890674942e-06
	iters: 100, epoch: 3 | loss: 0.5286369
	speed: 0.0707s/iter; left time: 997.7916s
Epoch: 3 cost time: 5.487223386764526
Epoch: 3, Steps: 145 | Train Loss: 0.4784385 Vali Loss: 0.4292874 Test Loss: 0.3462036
Validation loss decreased (0.458099 --> 0.429287).  Saving model ...
Updating learning rate to 9.235229667925671e-06
	iters: 100, epoch: 4 | loss: 0.5144990
	speed: 0.0704s/iter; left time: 983.7970s
Epoch: 4 cost time: 5.522824287414551
Epoch: 4, Steps: 145 | Train Loss: 0.4603661 Vali Loss: 0.4152306 Test Loss: 0.3386197
Validation loss decreased (0.429287 --> 0.415231).  Saving model ...
Updating learning rate to 1.3173300113241337e-05
	iters: 100, epoch: 5 | loss: 0.4758688
	speed: 0.0717s/iter; left time: 991.1828s
Epoch: 5 cost time: 5.568983793258667
Epoch: 5, Steps: 145 | Train Loss: 0.4483081 Vali Loss: 0.4015457 Test Loss: 0.3278965
Validation loss decreased (0.415231 --> 0.401546).  Saving model ...
Updating learning rate to 1.8068071090939942e-05
	iters: 100, epoch: 6 | loss: 0.4054144
	speed: 0.0702s/iter; left time: 960.3029s
Epoch: 6 cost time: 5.535009145736694
Epoch: 6, Steps: 145 | Train Loss: 0.4413525 Vali Loss: 0.3859833 Test Loss: 0.3383533
Validation loss decreased (0.401546 --> 0.385983).  Saving model ...
Updating learning rate to 2.3798934101872327e-05
	iters: 100, epoch: 7 | loss: 0.4947520
	speed: 0.0707s/iter; left time: 956.1875s
Epoch: 7 cost time: 5.480576276779175
Epoch: 7, Steps: 145 | Train Loss: 0.4347174 Vali Loss: 0.3758196 Test Loss: 0.3338905
Validation loss decreased (0.385983 --> 0.375820).  Saving model ...
Updating learning rate to 3.02246791099148e-05
	iters: 100, epoch: 8 | loss: 0.4313499
	speed: 0.0698s/iter; left time: 934.2243s
Epoch: 8 cost time: 5.458041191101074
Epoch: 8, Steps: 145 | Train Loss: 0.4295473 Vali Loss: 0.3603042 Test Loss: 0.3497517
Validation loss decreased (0.375820 --> 0.360304).  Saving model ...
Updating learning rate to 3.718697399598229e-05
	iters: 100, epoch: 9 | loss: 0.4417337
	speed: 0.0697s/iter; left time: 922.6230s
Epoch: 9 cost time: 5.477287769317627
Epoch: 9, Steps: 145 | Train Loss: 0.4247332 Vali Loss: 0.3663948 Test Loss: 0.3647064
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.451426590486085e-05
	iters: 100, epoch: 10 | loss: 0.3939561
	speed: 0.0696s/iter; left time: 910.9834s
Epoch: 10 cost time: 5.440526485443115
Epoch: 10, Steps: 145 | Train Loss: 0.4121311 Vali Loss: 0.3854980 Test Loss: 0.4016484
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.202600835460393e-05
	iters: 100, epoch: 11 | loss: 0.3661668
	speed: 0.0695s/iter; left time: 900.6572s
Epoch: 11 cost time: 5.448892831802368
Epoch: 11, Steps: 145 | Train Loss: 0.3980641 Vali Loss: 0.4024789 Test Loss: 0.4146690
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.953710995135747e-05
	iters: 100, epoch: 12 | loss: 0.3682747
	speed: 0.0710s/iter; left time: 909.7898s
Epoch: 12 cost time: 5.508943557739258
Epoch: 12, Steps: 145 | Train Loss: 0.3900748 Vali Loss: 0.4374797 Test Loss: 0.4348469
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.686249509206085e-05
	iters: 100, epoch: 13 | loss: 0.3961214
	speed: 0.0695s/iter; left time: 879.9539s
Epoch: 13 cost time: 5.5007288455963135
Epoch: 13, Steps: 145 | Train Loss: 0.3787453 Vali Loss: 0.4388292 Test Loss: 0.4543939
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.382166427805819e-05
	iters: 100, epoch: 14 | loss: 0.3950802
	speed: 0.0705s/iter; left time: 881.9320s
Epoch: 14 cost time: 5.483083009719849
Epoch: 14, Steps: 145 | Train Loss: 0.3648580 Vali Loss: 0.4512920 Test Loss: 0.4418109
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.024314167224247e-05
	iters: 100, epoch: 15 | loss: 0.3581263
	speed: 0.0694s/iter; left time: 859.1433s
Epoch: 15 cost time: 5.490719556808472
Epoch: 15, Steps: 145 | Train Loss: 0.3504369 Vali Loss: 0.5317096 Test Loss: 0.4328365
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.59687003107043e-05
	iters: 100, epoch: 16 | loss: 0.2902587
	speed: 0.0697s/iter; left time: 852.3982s
Epoch: 16 cost time: 5.488293409347534
Epoch: 16, Steps: 145 | Train Loss: 0.3397764 Vali Loss: 0.5473076 Test Loss: 0.4050109
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.08572608585123e-05
	iters: 100, epoch: 17 | loss: 0.3127298
	speed: 0.0701s/iter; left time: 847.3795s
Epoch: 17 cost time: 5.511888265609741
Epoch: 17, Steps: 145 | Train Loss: 0.3266669 Vali Loss: 0.5328413 Test Loss: 0.4528363
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.478836784321281e-05
	iters: 100, epoch: 18 | loss: 0.3256418
	speed: 0.0698s/iter; left time: 833.4311s
Epoch: 18 cost time: 5.513291358947754
Epoch: 18, Steps: 145 | Train Loss: 0.3136786 Vali Loss: 0.6211444 Test Loss: 0.4583782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 336_336_PatchTST_custom_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1182
mse:0.3497518002986908, mae:0.43075448274612427, rse:0.4607623219490051
