Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='336_192', model='PatchTST', data='custom', root_path='./dataset/', data_path='exchange_rate.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.2, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 336_192_PatchTST_custom_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.3400929
	speed: 0.0451s/iter; left time: 667.3869s
Epoch: 1 cost time: 6.257101058959961
Epoch: 1, Steps: 149 | Train Loss: 0.4154464 Vali Loss: 0.3127640 Test Loss: 0.2452369
Validation loss decreased (inf --> 0.312764).  Saving model ...
Updating learning rate to 4.591355651572507e-06
	iters: 100, epoch: 2 | loss: 0.3839055
	speed: 0.0716s/iter; left time: 1048.7136s
Epoch: 2 cost time: 5.469155788421631
Epoch: 2, Steps: 149 | Train Loss: 0.3246203 Vali Loss: 0.2740651 Test Loss: 0.2109534
Validation loss decreased (0.312764 --> 0.274065).  Saving model ...
Updating learning rate to 6.350851710179711e-06
	iters: 100, epoch: 3 | loss: 0.3767120
	speed: 0.0715s/iter; left time: 1036.9240s
Epoch: 3 cost time: 5.481491565704346
Epoch: 3, Steps: 149 | Train Loss: 0.2942353 Vali Loss: 0.2571302 Test Loss: 0.1922504
Validation loss decreased (0.274065 --> 0.257130).  Saving model ...
Updating learning rate to 9.235134511730939e-06
	iters: 100, epoch: 4 | loss: 0.2377881
	speed: 0.0708s/iter; left time: 1016.4511s
Epoch: 4 cost time: 5.544806003570557
Epoch: 4, Steps: 149 | Train Loss: 0.2753604 Vali Loss: 0.2432319 Test Loss: 0.1892931
Validation loss decreased (0.257130 --> 0.243232).  Saving model ...
Updating learning rate to 1.3173135850583215e-05
	iters: 100, epoch: 5 | loss: 0.2612177
	speed: 0.0713s/iter; left time: 1013.4800s
Epoch: 5 cost time: 5.560364007949829
Epoch: 5, Steps: 149 | Train Loss: 0.2622699 Vali Loss: 0.2326684 Test Loss: 0.1825222
Validation loss decreased (0.243232 --> 0.232668).  Saving model ...
Updating learning rate to 1.8067824087251972e-05
	iters: 100, epoch: 6 | loss: 0.1748995
	speed: 0.0715s/iter; left time: 1004.5102s
Epoch: 6 cost time: 5.550533056259155
Epoch: 6, Steps: 149 | Train Loss: 0.2544382 Vali Loss: 0.2254007 Test Loss: 0.1839127
Validation loss decreased (0.232668 --> 0.225401).  Saving model ...
Updating learning rate to 2.3798594990427212e-05
	iters: 100, epoch: 7 | loss: 0.2518829
	speed: 0.0726s/iter; left time: 1010.1179s
Epoch: 7 cost time: 5.555439472198486
Epoch: 7, Steps: 149 | Train Loss: 0.2482917 Vali Loss: 0.2168755 Test Loss: 0.1851181
Validation loss decreased (0.225401 --> 0.216875).  Saving model ...
Updating learning rate to 3.022424340338145e-05
	iters: 100, epoch: 8 | loss: 0.2933036
	speed: 0.0710s/iter; left time: 976.9022s
Epoch: 8 cost time: 5.53235125541687
Epoch: 8, Steps: 149 | Train Loss: 0.2444527 Vali Loss: 0.2162784 Test Loss: 0.1925160
Validation loss decreased (0.216875 --> 0.216278).  Saving model ...
Updating learning rate to 3.718644251344725e-05
	iters: 100, epoch: 9 | loss: 0.2083625
	speed: 0.0710s/iter; left time: 966.4570s
Epoch: 9 cost time: 5.5062055587768555
Epoch: 9, Steps: 149 | Train Loss: 0.2403415 Vali Loss: 0.2198772 Test Loss: 0.2020518
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.4513644995995e-05
	iters: 100, epoch: 10 | loss: 0.1977341
	speed: 0.0704s/iter; left time: 947.0777s
Epoch: 10 cost time: 5.4655327796936035
Epoch: 10, Steps: 149 | Train Loss: 0.2359497 Vali Loss: 0.2291632 Test Loss: 0.2091917
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.20253099094301e-05
	iters: 100, epoch: 11 | loss: 0.2252425
	speed: 0.0704s/iter; left time: 937.6712s
Epoch: 11 cost time: 5.4876549243927
Epoch: 11, Steps: 149 | Train Loss: 0.2309926 Vali Loss: 0.2463136 Test Loss: 0.2160175
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.9536351191282605e-05
	iters: 100, epoch: 12 | loss: 0.1779743
	speed: 0.0711s/iter; left time: 935.3084s
Epoch: 12 cost time: 5.511860370635986
Epoch: 12, Steps: 149 | Train Loss: 0.2264041 Vali Loss: 0.2507416 Test Loss: 0.2276194
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.686169814525177e-05
	iters: 100, epoch: 13 | loss: 0.2035675
	speed: 0.0707s/iter; left time: 920.0376s
Epoch: 13 cost time: 5.5396740436553955
Epoch: 13, Steps: 149 | Train Loss: 0.2215899 Vali Loss: 0.2843943 Test Loss: 0.2126206
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.3820855549631e-05
	iters: 100, epoch: 14 | loss: 0.2233500
	speed: 0.0718s/iter; left time: 923.4260s
Epoch: 14 cost time: 5.492863416671753
Epoch: 14, Steps: 149 | Train Loss: 0.2166667 Vali Loss: 0.3041779 Test Loss: 0.2209493
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.024235102686764e-05
	iters: 100, epoch: 15 | loss: 0.2226456
	speed: 0.0706s/iter; left time: 897.4127s
Epoch: 15 cost time: 5.5333356857299805
Epoch: 15, Steps: 149 | Train Loss: 0.2112079 Vali Loss: 0.3008890 Test Loss: 0.2208723
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.596796009187795e-05
	iters: 100, epoch: 16 | loss: 0.2682001
	speed: 0.0717s/iter; left time: 900.4838s
Epoch: 16 cost time: 5.535134315490723
Epoch: 16, Steps: 149 | Train Loss: 0.2048387 Vali Loss: 0.3542867 Test Loss: 0.2257488
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.085660477469153e-05
	iters: 100, epoch: 17 | loss: 0.2145673
	speed: 0.0712s/iter; left time: 883.8907s
Epoch: 17 cost time: 5.5589799880981445
Epoch: 17, Steps: 149 | Train Loss: 0.1980290 Vali Loss: 0.3573112 Test Loss: 0.2314575
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.478782975607041e-05
	iters: 100, epoch: 18 | loss: 0.1504912
	speed: 0.0711s/iter; left time: 872.5170s
Epoch: 18 cost time: 5.548223972320557
Epoch: 18, Steps: 149 | Train Loss: 0.1909056 Vali Loss: 0.3349720 Test Loss: 0.2136368
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 336_192_PatchTST_custom_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.1925159990787506, mae:0.31409215927124023, rse:0.3381345272064209
