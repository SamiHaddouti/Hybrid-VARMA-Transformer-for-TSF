Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='336_96', model='PatchTST', data='custom', root_path='./dataset/', data_path='exchange_rate_VARMA_All_Residuals.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='mse', lradj='TST', pct_start=0.2, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.7773781
	speed: 0.0557s/iter; left time: 840.8565s
Epoch: 1 cost time: 7.992688179016113
Epoch: 1, Steps: 152 | Train Loss: 0.7211324 Vali Loss: 0.7978342 Test Loss: 4.5880246
Validation loss decreased (inf --> 0.797834).  Saving model ...
Updating learning rate to 4.591347831932931e-06
	iters: 100, epoch: 2 | loss: 0.5616384
	speed: 0.0931s/iter; left time: 1391.6024s
Epoch: 2 cost time: 7.289078235626221
Epoch: 2, Steps: 152 | Train Loss: 0.6247467 Vali Loss: 0.7435704 Test Loss: 3.3526011
Validation loss decreased (0.797834 --> 0.743570).  Saving model ...
Updating learning rate to 6.35082081696788e-06
	iters: 100, epoch: 3 | loss: 0.7225799
	speed: 0.0941s/iter; left time: 1391.9594s
Epoch: 3 cost time: 7.342072010040283
Epoch: 3, Steps: 152 | Train Loss: 0.5638858 Vali Loss: 0.6975266 Test Loss: 2.7692802
Validation loss decreased (0.743570 --> 0.697527).  Saving model ...
Updating learning rate to 9.235066432811335e-06
	iters: 100, epoch: 4 | loss: 0.5126885
	speed: 0.0946s/iter; left time: 1385.3277s
Epoch: 4 cost time: 7.377694129943848
Epoch: 4, Steps: 152 | Train Loss: 0.5002490 Vali Loss: 0.6464881 Test Loss: 2.4284246
Validation loss decreased (0.697527 --> 0.646488).  Saving model ...
Updating learning rate to 1.3173018329809463e-05
	iters: 100, epoch: 5 | loss: 0.3647961
	speed: 0.0951s/iter; left time: 1378.9988s
Epoch: 5 cost time: 7.487104177474976
Epoch: 5, Steps: 152 | Train Loss: 0.4573390 Vali Loss: 0.6186213 Test Loss: 2.3464382
Validation loss decreased (0.646488 --> 0.618621).  Saving model ...
Updating learning rate to 1.8067647369772875e-05
	iters: 100, epoch: 6 | loss: 0.4426621
	speed: 0.0943s/iter; left time: 1351.7149s
Epoch: 6 cost time: 7.464231729507446
Epoch: 6, Steps: 152 | Train Loss: 0.4412935 Vali Loss: 0.6070840 Test Loss: 2.2920341
Validation loss decreased (0.618621 --> 0.607084).  Saving model ...
Updating learning rate to 2.379835237474747e-05
	iters: 100, epoch: 7 | loss: 0.3646075
	speed: 0.0945s/iter; left time: 1340.2492s
Epoch: 7 cost time: 7.494667053222656
Epoch: 7, Steps: 152 | Train Loss: 0.4340754 Vali Loss: 0.6039914 Test Loss: 2.3220172
Validation loss decreased (0.607084 --> 0.603991).  Saving model ...
Updating learning rate to 3.022393167889412e-05
	iters: 100, epoch: 8 | loss: 0.5066517
	speed: 0.0965s/iter; left time: 1354.6119s
Epoch: 8 cost time: 7.6352057456970215
Epoch: 8, Steps: 152 | Train Loss: 0.4304387 Vali Loss: 0.5989482 Test Loss: 2.3266685
Validation loss decreased (0.603991 --> 0.598948).  Saving model ...
Updating learning rate to 3.718606226594531e-05
	iters: 100, epoch: 9 | loss: 0.3429371
	speed: 0.0967s/iter; left time: 1343.3555s
Epoch: 9 cost time: 7.6068689823150635
Epoch: 9, Steps: 152 | Train Loss: 0.4258576 Vali Loss: 0.5973479 Test Loss: 2.2777407
Validation loss decreased (0.598948 --> 0.597348).  Saving model ...
Updating learning rate to 4.45132007680558e-05
	iters: 100, epoch: 10 | loss: 0.4335694
	speed: 0.0970s/iter; left time: 1331.8000s
Epoch: 10 cost time: 7.670056343078613
Epoch: 10, Steps: 152 | Train Loss: 0.4234772 Vali Loss: 0.5924504 Test Loss: 2.2329688
Validation loss decreased (0.597348 --> 0.592450).  Saving model ...
Updating learning rate to 5.202481020741325e-05
	iters: 100, epoch: 11 | loss: 0.3681483
	speed: 0.0965s/iter; left time: 1310.5649s
Epoch: 11 cost time: 7.668407440185547
Epoch: 11, Steps: 152 | Train Loss: 0.4196231 Vali Loss: 0.5894510 Test Loss: 2.2039711
Validation loss decreased (0.592450 --> 0.589451).  Saving model ...
Updating learning rate to 5.953580833583889e-05
	iters: 100, epoch: 12 | loss: 0.4237423
	speed: 0.0974s/iter; left time: 1308.1591s
Epoch: 12 cost time: 7.715695381164551
Epoch: 12, Steps: 152 | Train Loss: 0.4170566 Vali Loss: 0.5933782 Test Loss: 2.2515032
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.686112796754533e-05
	iters: 100, epoch: 13 | loss: 0.4313540
	speed: 0.0974s/iter; left time: 1293.4102s
Epoch: 13 cost time: 7.789743423461914
Epoch: 13, Steps: 152 | Train Loss: 0.4135822 Vali Loss: 0.5951773 Test Loss: 2.2511702
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.382027694076487e-05
	iters: 100, epoch: 14 | loss: 0.4455132
	speed: 0.0993s/iter; left time: 1303.3162s
Epoch: 14 cost time: 7.825709104537964
Epoch: 14, Steps: 152 | Train Loss: 0.4101422 Vali Loss: 0.5963806 Test Loss: 2.1998491
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.024178535310538e-05
	iters: 100, epoch: 15 | loss: 0.3976000
	speed: 0.1000s/iter; left time: 1297.8962s
Epoch: 15 cost time: 7.864458799362183
Epoch: 15, Steps: 152 | Train Loss: 0.4056984 Vali Loss: 0.6038746 Test Loss: 2.1464877
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.596743049300946e-05
	iters: 100, epoch: 16 | loss: 0.4761521
	speed: 0.0985s/iter; left time: 1263.5082s
Epoch: 16 cost time: 7.854731321334839
Epoch: 16, Steps: 152 | Train Loss: 0.4027627 Vali Loss: 0.6033189 Test Loss: 2.1602256
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.085613536714795e-05
	iters: 100, epoch: 17 | loss: 0.3102391
	speed: 0.0996s/iter; left time: 1261.4650s
Epoch: 17 cost time: 7.901590824127197
Epoch: 17, Steps: 152 | Train Loss: 0.3995894 Vali Loss: 0.6106721 Test Loss: 2.0947502
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.478744476600916e-05
	iters: 100, epoch: 18 | loss: 0.4748340
	speed: 0.0996s/iter; left time: 1246.4318s
Epoch: 18 cost time: 7.954500675201416
Epoch: 18, Steps: 152 | Train Loss: 0.3969210 Vali Loss: 0.6101655 Test Loss: 2.2963629
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.766449321919e-05
	iters: 100, epoch: 19 | loss: 0.3009771
	speed: 0.0999s/iter; left time: 1234.9053s
Epoch: 19 cost time: 8.019039154052734
Epoch: 19, Steps: 152 | Train Loss: 0.3946329 Vali Loss: 0.6210787 Test Loss: 2.0952940
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.941639171147566e-05
	iters: 100, epoch: 20 | loss: 0.3564470
	speed: 0.1017s/iter; left time: 1241.7165s
Epoch: 20 cost time: 8.090934038162231
Epoch: 20, Steps: 152 | Train Loss: 0.3924982 Vali Loss: 0.6203995 Test Loss: 2.0664151
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.999999833132844e-05
	iters: 100, epoch: 21 | loss: 0.3385661
	speed: 0.1022s/iter; left time: 1232.7204s
Epoch: 21 cost time: 8.064766645431519
Epoch: 21, Steps: 152 | Train Loss: 0.3899478 Vali Loss: 0.6178520 Test Loss: 2.1962621
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:2.2039713859558105, mae:0.5842860341072083, rse:0.44815704226493835
